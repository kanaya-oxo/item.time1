<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>OBS時計カスタムジェネレーター</title>
  <style>
    body {
      font-family: sans-serif;
    }

    #preview {
      width: 350px;
      position: relative;
      margin-top: 20px;
      border: 1px solid #aaa;
    }

    #previewImage {
      width: 100%;
      display: block;
    }

    #previewOverlay {
      position: absolute;
      inset: 0;
      mix-blend-mode: multiply;
      z-index: 1;
      pointer-events: none;
    }

    #previewText {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: bold;
      font-size: 48px;
      z-index: 2;
      white-space: nowrap;
      background: linear-gradient(90deg, #00ffcc, #ff00ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .thumbnail {
      width: 80px;
      height: 60px;
      object-fit: contain;
      border: 2px solid transparent;
      cursor: pointer;
      margin: 4px;
    }

    .selected {
      border-color: red;
    }
  </style>
</head>
<body>
  <h1>OBS 時計 URL ジェネレーター</h1>

  <form id="form">
    <label>文字サイズ（px）：
      <input type="number" id="size" value="48">
    </label><br><br>

    <label>グラデーション開始色：
      <input type="color" id="gradFrom" value="#00ffcc">
    </label>

    <label>終了色：
      <input type="color" id="gradTo" value="#ff00ff">
    </label><br><br>

    <label>背景の乗算カラー（例: rgba(0,0,0,0.3)）：
      <input type="text" id="multiply" value="rgba(0,0,0,0.3)">
    </label><br><br>

    <p>背景画像：</p>
    <div id="bgSelector"></div>

    <div id="preview">
      <img id="previewImage" src="" alt="背景画像">
      <div id="previewOverlay"></div>
      <div id="previewText">12:34:56</div>
    </div><br>

    <button type="submit">URL生成</button>
  </form>

  <p>生成されたURL：</p>
  <textarea id="output" rows="3" cols="80" readonly></textarea>

  <script>
    const bgImages = [
      { name: "背景1", url: "https://kanaya-oxo.github.io/assets/bg1.png" },
      { name: "背景2", url: "https://kanaya-oxo.github.io/assets/bg1.png" },
      { name: "背景3", url: "https://kanaya-oxo.github.io/assets/bg1.png" }
    ];

    let selectedBg = bgImages[0].url;

    function updatePreview() {
      const gradFrom = document.getElementById("gradFrom").value;
      const gradTo = document.getElementById("gradTo").value;
      const size = document.getElementById("size").value;
      const multiply = document.getElementById("multiply").value;

      document.getElementById("previewImage").src = selectedBg;
      document.getElementById("previewOverlay").style.backgroundColor = multiply;

      const text = document.getElementById("previewText");
      text.style.background = `linear-gradient(90deg, ${gradFrom}, ${gradTo})`;
      text.style.fontSize = `${size}px`;
    }

    function initBgSelector() {
      const container = document.getElementById("bgSelector");
      bgImages.forEach((img, idx) => {
        const thumb = document.createElement("img");
        thumb.src = img.url;
        thumb.className = "thumbnail";
        if (idx === 0) thumb.classList.add("selected");

        thumb.addEventListener("click", () => {
          selectedBg = img.url;
          document.querySelectorAll(".thumbnail").forEach(el => el.classList.remove("selected"));
          thumb.classList.add("selected");
          updatePreview();
        });

        container.appendChild(thumb);
      });
    }

    document.querySelectorAll("input").forEach(input => {
      input.addEventListener("input", updatePreview);
    });

    document.getElementById("form").addEventListener("submit", function (e) {
      e.preventDefault();

      const base = 'https://kanaya-oxo.github.io/item.time1/'; // ← 実際のデプロイURLに変更
      const params = new URLSearchParams();

      params.set("bgImage", selectedBg);
      params.set("multiply", document.getElementById("multiply").value);
      params.set("size", document.getElementById("size").value);
      params.set("gradFrom", document.getElementById("gradFrom").value);
      params.set("gradTo", document.getElementById("gradTo").value);

      document.getElementById("output").value = `${base}?${params.toString()}`;
    });

    initBgSelector();
    updatePreview();
  </script>
</body>
</html>
